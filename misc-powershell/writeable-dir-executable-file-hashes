#one-liner to record path\filename and calcualte sha1 hash value for all files within "c:\users" and "c:\programdata" modified in the last 5 days, writing output to csv
$FormatEnumerationLimit=-1; $paths='c:\users','c:\programdata'; get-childitem -path $paths -Recurse -Force -ErrorAction SilentlyContinue | where {$_.LastWriteTime -gt (get-date).AddDays(-5)} | where {$_.extension -in ".exe",".bat",".ps1",".json",".dll",".vbs",".cmd",".scr"} | Get-FileHash -Algorithm sha1 -ErrorAction SilentlyContinue | export-csv user-profile-and-programdata-hashes-modified-10-days.csv -NoTypeInformation
